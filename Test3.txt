import gitlab

# Replace with your GitLab instance URL and personal access token
GITLAB_URL = "https://gitlab.com"
PRIVATE_TOKEN = "YOUR_PRIVATE_TOKEN"
PROJECT_ID = "YOUR_PROJECT_ID"
MILESTONE_ID = "YOUR_MILESTONE_ID"

# Initialize GitLab connection
gl = gitlab.Gitlab(GITLAB_URL, private_token=PRIVATE_TOKEN)

# Get the project
project = gl.projects.get(PROJECT_ID)

# Get the milestone
milestone = project.milestones.get(MILESTONE_ID)

# Get merge requests associated with the milestone
merge_requests = project.mergerequests.list(state='all', milestone=milestone.title, all=True)

def calculate_progress(merge_requests):
    total_mrs = len(merge_requests)
    merged_mrs = sum(1 for mr in merge_requests if mr.state == "merged")

    if total_mrs == 0:
        return 0
    return (merged_mrs / total_mrs) * 100

def main():
    progress = calculate_progress(merge_requests)
    print(f"Milestone Progress: {progress:.2f}%")

if __name__ == "__main__":
    main()

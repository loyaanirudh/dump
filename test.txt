import gitlab

# Replace these variables with your own values
GITLAB_URL = "https://gitlab.example.com"
PRIVATE_TOKEN = "your_private_token"
GROUP_ID = "your_group_id"

# Initialize the GitLab connection
gl = gitlab.Gitlab(GITLAB_URL, private_token=PRIVATE_TOKEN)

def update_project_settings(project):
    """Update project settings"""
    settings = {
        "approvals_before_merge": 2,  # Number of approvals required
        "squash_option": "always",  # Squash commits option
        "only_allow_merge_if_pipeline_succeeds": True,
        "only_allow_merge_if_all_discussions_are_resolved": True
    }

    project.merge_requests_settings = settings
    project.save()
    print(f"Updated settings for project {project.id}")

def main():
    group = gl.groups.get(GROUP_ID)
    projects = group.projects.list(all=True)

    for project in projects:
        proj = gl.projects.get(project.id)
        update_project_settings(proj)

if __name__ == "__main__":
    main()
